syntax = "proto3";

package purpose.template.v2;

enum PurposeTemplateStateV2 {
  DRAFT = 0;
  ACTIVE = 1;
  SUSPENDED = 2;
  ARCHIVED = 3;
}

// TODO: the purpose template is not final
message PurposeTemplateV2 {
  string id = 1;
  string name = 2;
  string target = 3;
  string creatorId = 4;
  repeated  eservicesVersions = 5
  PurposeTemplateStateV2 state = 6;
  string title = 7;
  string description = 8;
  optional PurposeRiskAnalysisFormTemplateV2 riskAnalysisForm = 9;
  int64 createdAt = 10;
  optional int64 updatedAt = 11;
  bool isFreeOfCharge = 12;
  optional string freeOfChargeReason = 13;
  optional int32 dailyCalls = 14;
}

message EserviceDescriptorVersionPurposeTemplateV2 {
  string eserviceId = 1;
  string descriptorId = 2;
}

// TODO: move the risk analysis template to a separate file if it's needed
message PurposeRiskAnalysisFormTemplateV2 {
  string id = 1;
  string version = 2;
  repeated RiskAnalysisTemplateSingleAnswerV2 singleAnswers = 3;
  repeated RiskAnalysisTemplateMultiAnswerV2 multiAnswers = 4;
}

message RiskAnalysisTemplateSingleAnswerV2 {
  string id = 1;
  string key = 2;
  optional string value = 3;
  bool editable = 4;
  optional RiskAnalysisTemplateAnswerAnnotationV2 annotation = 5;
  optional string instruction = 6;
  repeated string suggestedValues = 7;
}

message RiskAnalysisTemplateMultiAnswerV2 {
  string id = 1;
  string key = 2;
  repeated string values = 3;
  bool editable = 4;
  optional RiskAnalysisTemplateAnswerAnnotationV2 annotation = 5;
  optional string instruction = 6;
}

message RiskAnalysisTemplateAnswerAnnotationV2 {
  string id = 1;
  optional string text = 2;
  repeated RiskAnalysisTemplateAnnotationDocumentV2 docs = 3;
  repeated LinkV2 urls = 4;
}

message RiskAnalysisTemplateAnnotationDocumentV2 {
  string id = 1;
  string name = 2;
  string contentType = 3;
  string prettyName = 4;
  string path = 5;
  int64 createdAt = 6;
}

message LinkV2 {
  string id = 1;
  string url = 2;
  string text = 3;
}
