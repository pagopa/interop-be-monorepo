syntax = "proto3";

package purpose.template.v2;

import "v2/tenant/tenant.proto";

enum PurposeTemplateStateV2 {
  DRAFT = 0;
  ACTIVE = 1;
  SUSPENDED = 2;
  ARCHIVED = 3;
}

// TODO: the purpose template is not final
message PurposeTemplateV2 {
  string id = 1;
  string target = 2;
  tenant.v2.TenantKindV2 tenantKind = 3;
  string creatorId = 4;
  repeated EserviceDescriptorVersionPurposeTemplateV2 eservicesVersions = 5;
  PurposeTemplateStateV2 state = 6;
  int64 createdAt = 7;
  optional int64 updatedAt = 8;
  string purposeTitle = 9;
  string purposeDescription = 10;
  optional RiskAnalysisFormTemplateV2 purposeRiskAnalysisForm = 11;
  bool purposeIsFreeOfCharge = 12;
  optional string purposeFreeOfChargeReason = 13;
  optional int32 purposeDailyCalls = 14;
}

message EserviceDescriptorVersionPurposeTemplateV2 {
  string eserviceId = 1;
  string descriptorId = 2;
}

// TODO: move the risk analysis template to a separate file if it's needed
message RiskAnalysisFormTemplateV2 {
  string id = 1;
  string version = 2;
  repeated RiskAnalysisTemplateSingleAnswerV2 singleAnswers = 3;
  repeated RiskAnalysisTemplateMultiAnswerV2 multiAnswers = 4;
}

message RiskAnalysisTemplateSingleAnswerV2 {
  string id = 1;
  string key = 2;
  optional string value = 3;
  bool editable = 4;
  optional RiskAnalysisTemplateAnswerAnnotationV2 annotation = 5;
  optional string assistiveText = 6;
  repeated string suggestedValues = 7;
}

message RiskAnalysisTemplateMultiAnswerV2 {
  string id = 1;
  string key = 2;
  repeated string values = 3;
  bool editable = 4;
  optional RiskAnalysisTemplateAnswerAnnotationV2 annotation = 5;
  optional string assistiveText = 6;
}

message RiskAnalysisTemplateAnswerAnnotationV2 {
  string id = 1;
  optional string text = 2;
  repeated RiskAnalysisTemplateAnnotationDocumentV2 docs = 3;
  repeated LinkV2 urls = 4;
}

message RiskAnalysisTemplateAnnotationDocumentV2 {
  string id = 1;
  string name = 2;
  string contentType = 3;
  string prettyName = 4;
  string path = 5;
  int64 createdAt = 6;
}

message LinkV2 {
  string id = 1;
  string url = 2;
  string text = 3;
}
